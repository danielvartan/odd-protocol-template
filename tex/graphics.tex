% Set distance from top of page to first float -----

\makeatletter
\setlength{\@fptop}{5pt}
\makeatother

% Set captions and legends -----

\DeclareCaptionFont{ABNTEXfontereduzida}{\ABNTEXfontereduzida}

% For customization, see `\DeclareCaptionFormat` in the `caption` package.
\captionsetup{
  font=ABNTEXfontereduzida,
  justification=justified
}

\renewcommand{\abovecaptionskip}{\smallskipamount}
\renewcommand{\belowcaptionskip}{\smallskipamount}

\renewcommand{\legend}[1]{
  \hyphenpenalty=100000
  \ABNTEXfontereduzida
  \addvspace{\smallskipamount}
  #1
}

% Credits: <https://tex.stackexchange.com/a/611556/234832>.
\AddToHook{cmd/caption/before}{\hyphenpenalty=100000}

% Set figure environment -----

\AtBeginEnvironment{figure}{
  \ABNTEXfontereduzida
  \addvspace{\tinyskipamount}
}

\AtEndEnvironment{figure}{
  \addvspace{\smallskipamount}
}
